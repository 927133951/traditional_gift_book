# 电子礼薄书项目说明书

## 1. 项目概述

电子礼薄书是一个中国传统风格的前端应用，用于记录和管理礼金礼品信息。项目采用纯前端技术实现，具有传统古籍风格的界面设计，支持多页面记录管理、金额自动转换为中文大写、实时计算金额小计和总计、导出Word和打印功能等。

### 1.1 主要功能

- 传统古籍风格的界面设计
- 支持多页面记录管理
- 金额自动转换为中文大写
- 实时计算金额小计和总计
- 支持导出Word和打印功能
- 响应式设计，适配不同设备
- 本地数据存储，自动保存

## 2. 项目结构

项目采用简洁的前端项目结构，主要文件如下：

| 文件名 | 类型 | 功能描述 |
|-------|------|----------|
| index.html | 页面文件 | 应用主页面，包含页面结构和控制面板 |
| traditional_script.js | 脚本文件 | 核心功能实现，包含数据管理、表格操作等 |
| traditional_style.css | 样式文件 | 传统古籍风格的样式设计 |
| package.json | 配置文件 | 项目依赖和脚本配置 |
| README.md | 说明文件 | 项目功能简介 |
| code_review_report.md | 报告文件 | 代码审阅报告 |
| 项目说明书.md | 说明文件 | 项目详细说明 |

## 3. 技术栈

### 3.1 前端技术

- **HTML5**：页面结构和语义化标签
- **CSS3**：样式设计，包括变量、渐变、动画等
- **JavaScript (ES6+)**：核心功能实现，使用类和现代语法
- **LocalStorage**：本地数据存储

### 3.2 外部资源

- **Google Fonts**：引入了Noto Serif SC、Noto Sans SC和Ma Shan Zheng字体
- **SVG**：用于纸张纹理效果

### 3.3 依赖管理

项目使用npm进行依赖管理，但依赖非常简单：
- **nodemon**：用于开发环境的文件监控和自动重启

## 4. 使用方法

### 4.1 启动项目

1. 确保安装了Node.js环境
2. 进入项目目录
3. 安装依赖：`npm install`
4. 启动开发服务器：`python -m http.server 8000`（或使用其他HTTP服务器）
5. 在浏览器中访问：`http://localhost:8000`

### 4.2 基本操作

1. **填写礼事信息**：在页面顶部填写礼事主题和地点
2. **添加记录**：在表格中填写宾客姓名、礼金、礼品和地址信息
3. **新增页面**：点击"新增一页"按钮添加新的记录页面
4. **删除页面**：点击"删除页面"按钮删除指定页面
5. **导出Word**：点击"导出Word"按钮将记录导出为Word文档
6. **打印档案**：点击"打印档案"按钮打印记录
7. **保存档案**：点击"保存档案"按钮保存数据
8. **重置档案**：点击"重置档案"按钮清除所有数据并保留一个空白页面

### 4.3 键盘快捷键

- **Ctrl+S**：保存档案
- **Ctrl+P**：打印档案
- **Ctrl+E**：导出Word

## 5. 核心功能说明

### 5.1 表格管理

- **表格结构**：表格包含"宾客姓名、礼金、礼金大写、礼品、地址"五列
- **垂直堆叠**：支持多个表格垂直堆叠显示
- **动态生成**：根据数据自动生成表格和行
- **页面管理**：支持新增和删除页面

### 5.2 金额处理

- **自动转换**：输入数字金额时，系统会自动转换为中文大写
- **实时计算**：输入金额时，系统会实时计算本页小计和总计
- **格式验证**：确保金额格式正确

### 5.3 数据管理

- **本地存储**：使用LocalStorage存储数据，无需后端服务器
- **自动保存**：每30秒自动保存数据，页面卸载前也会保存
- **数据结构**：使用对象存储记录和元数据

### 5.4 导出和打印

- **Word导出**：将记录导出为Word文档，包含所有记录和总计
- **打印功能**：优化的打印样式，确保表格铺满纸张
- **响应式打印**：适配不同纸张尺寸和方向

### 5.5 传统日期

- **公历日期**：显示当前公历日期
- **传统日期**：显示农历风格的日期，包括年份、月份、日期的生肖
- **时辰显示**：显示当前时辰（如子时、丑时等）

## 6. 页面布局

### 6.1 整体布局

- **页眉**：包含标题、副标题和元数据（礼事主题、地点等）
- **主内容区**：垂直堆叠的表格区域，用于记录宾客信息
- **控制面板**：固定在右下角的功能按钮，包括新增页面、删除页面、导出Word、打印档案、保存档案、重置档案

### 6.2 表格布局

表格包含以下列：
1. **宾客姓名**：输入宾客的姓名
2. **礼金**：输入礼金金额（数字）
3. **礼金大写**：自动转换的礼金大写金额（只读）
4. **礼品**：输入礼品信息
5. **地址**：输入宾客的地址

### 6.3 响应式设计

- **桌面端**：完整显示所有列和功能按钮
- **平板端**：适配中等屏幕尺寸，调整布局
- **移动端**：适配小屏幕尺寸，控制面板变为水平排列

## 7. 数据结构

### 7.1 记录数据结构

```javascript
{
  "records": {
    "0": {
      "name": "张三",
      "amount": "1000",
      "amountCapital": "壹仟元整",
      "gift": "礼金",
      "address": "北京市朝阳区"
    },
    "1": {
      "name": "李四",
      "amount": "500",
      "amountCapital": "伍佰元整",
      "gift": "礼金",
      "address": "上海市浦东新区"
    }
  },
  "meta": {
    "eventTitle": "婚礼",
    "eventLocation": "北京饭店",
    "createDate": "2026-01-29",
    "archiveNumber": "LB-2026-001"
  }
}
```

### 7.2 元数据结构

- **eventTitle**：礼事主题
- **eventLocation**：礼事地点
- **createDate**：创建日期
- **archiveNumber**：档案编号

## 8. 常见问题与解决方案

### 8.1 数据丢失

**问题**：刷新页面后数据丢失

**解决方案**：项目使用LocalStorage存储数据，正常情况下数据会自动保存。如果数据丢失，可能是因为浏览器清除了本地存储，或者LocalStorage容量不足。建议定期导出Word文档备份数据。

### 8.2 打印格式不正确

**问题**：打印时表格格式不正确

**解决方案**：项目已经优化了打印样式，确保表格铺满纸张。如果打印格式仍然不正确，可以尝试调整浏览器的打印设置，如边距、缩放比例等。

### 8.3 导出Word失败

**问题**：导出Word文档失败

**解决方案**：导出Word功能使用浏览器的Blob API实现，如果浏览器不支持此API，可能会导致导出失败。建议使用现代浏览器，如Chrome、Firefox、Edge等。

### 8.4 页面加载缓慢

**问题**：页面加载缓慢

**解决方案**：项目使用了一些外部字体和SVG纹理，可能会导致页面加载缓慢。如果网络环境较差，可以考虑离线使用项目，或者优化网络连接。

## 9. 未来扩展

### 9.1 功能扩展

- 添加数据导入功能，支持从Excel或CSV导入
- 实现数据备份和恢复功能
- 添加模板选择功能，支持不同场合的礼薄模板
- 添加数据统计和分析功能

### 9.2 技术改进

- 使用现代前端框架（如Vue或React）重构，提高代码可维护性
- 实现PWA功能，支持离线使用
- 添加数据加密功能，保护敏感信息
- 使用IndexedDB存储大量数据

### 9.3 界面优化

- 添加更多传统元素，如印章、书法等
- 优化打印样式，支持更多纸张尺寸
- 添加主题切换功能，支持不同风格
- 优化移动端体验

## 10. 总结

电子礼薄书项目是一个设计精美、功能完整的前端应用，成功实现了传统礼薄的数字化管理。项目采用纯前端技术实现，无需后端服务器，使用本地存储保存数据，适合个人或小型场合使用。

项目具有以下特点：
- 传统古籍风格的界面设计，美观大方
- 功能完整，支持多页面管理、金额自动转换、导出打印等
- 操作简单，界面直观，易于使用
- 响应式设计，适配不同设备
- 本地数据存储，自动保存，安全可靠

通过本项目，用户可以方便地记录和管理礼金礼品信息，减少纸质礼薄的使用，提高管理效率。